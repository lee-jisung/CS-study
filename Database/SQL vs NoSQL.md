## SQL (RDBMS)

 SQL을 사용하면 RDBMS에서 데이터를 저장, 수정, 삭제, 검색 할 수 있다.
 
 관계형 데이터베이스에는 핵심적인 두가지 특장이 있다.
 
  - 데이터는 **정해진 데이터 Schema**에 따라 테이블에 저장된다.
  
  - 데이터는 **관계를 통해 여러 테이블에 분산**된다.
  
 ### 엄격한 스키마
  
 데이터는 테이블에 레코드로 저장되는데, 각 테이블마다 명확하게 정의된 구조(structure)가 있다. 구조란 어떤 데이터가 테이블에 들어가고
 어떤 데이터가 그렇지 않을지를 정의하는 Filed 집합을 가르킨다. 
 
 구조는 필드의 이름과 데이터 유형으로 정의된다.
 
 ![image](https://user-images.githubusercontent.com/32594290/102349449-b19fcd00-3fe6-11eb-959e-7d68d5245865.png)

 
 **스키마를 준수하지 않은 레코드는 테이블에 추가할수 없다.** 즉, 스키마를 수정하지 않는 이상 정해진 구조에 맞는 레코드만 추가가
 가능한 것이 관계형 데이터베이스 특징 중 하나다.
 
 예를 들어 위 테이블에서 '유통기한'이라는 필드를 넣고 싶다면 스키마를 뜯어고치지 않는 한 필드를 추가할 수 없다.
 
 ### 관계
 
 SQL기반 DB의 중요한 부분은 관계이다.
 
 데이터들을 여러 테이블에 나누어 데이터의 중복을 피할 수 있다. 만약 사용자가 구입한 상품들을 나타내기 위해서 Users, Products, Orders 등
 여러 테이블을 만들어야 하지만, 각각의 테이블들은 다른 테이블에 저장되지 않은 데이터만을 갖고 있다 (중복된 데이터가 없음)
 
 ![image](https://user-images.githubusercontent.com/32594290/102349628-f9beef80-3fe6-11eb-8d1a-5536fcc6987c.png)

 이런 명확한 구조는 장점이 있다. 하나의 테이블에서 중복없이 하나의 데이터만을 관리하기 때문에 다른 테이블에서 부정확한 데이터를 다룰 위험이 없다.
 
## NoSQL (비관계형 데이터베이스)

NoSQL의 특징 
 
 - 스키마 없음
 
 - 관계 없음
 
NoSQL에서는 레코드를 문서(documents)라고 부른다.

SQL에서는 정해진 스키마를 따르지 않으면 데이터를 추가할 수 없지만, **NoSQL에서는 다른 구조의 데이터를 같은 컬렉션(=SQL에서의 테이블)에 추가할 수 있다**

![image](https://user-images.githubusercontent.com/32594290/102350471-51118f80-3fe8-11eb-8abe-6f494befa9ee.png)

문서는 JSON과 비슷한 형태를 갖고 있다. 또한, 스키마에 대해서는 신경 쓸 필요가 없다. 

일반적으로 관련 데이터를 동일한 컬렉션에 넣는다. 따라서 많은 Order(주문 상품)가 있을 경우 일반적인 정보를 모두 포함한 데이터를 
Orders 컬렉션에 저장한다. (RDBMS에서 사용했던 Users, Products 정보 또한 Orders에 한번에 저장됨)

따라서 여러 테이블, 콜렉션에 조인(join)할 필요없이 이미 필요한 모든 것을 갖춘 문서를 작성한다.

실제로 NoSQL에는 Join이라는 개념이 존재하지 않는다. 대신 컬렉션을 통해 **데이터를 복제**하여 각 컬렉션 일부분에 속하는 데이터를 
정확하게 산출하도록 한다.

이런 방식은 데이터가 중복되기 때문에 불안정한 측면이 있다. 실수로 컬렉션 B에는 데이터를 수정하지 않았는데, 컬렉션 A에만 데이터를
업데이트할 위험이 있다. 특정 데이터를 같이 사용하는 모든 컬렉션에서 똑같은 데이터 업데이트를 수행되도록 해야 한다.

**그럼에도 불구하고 이러한 방식의 큰 장점은 복잡한 조인을 사용할 필요가 없다는 것.** 필요한 모든 데이터가 이미 하나의 컬렉션 안에
저장되어 있기 때문이다.

자주 변경되지 않는 데이터일 때 큰 장점이 있다.

## 수직적 & 수평적 확장 (Vertical & Horizontal Scaling)

 두 종류의 DB를 비교할 때 고려해야 할 중요한 개념은 **확장(Scaling)**이다.
 
 확장은 **수직적(vertical) 확장**과 **수평적(horizontal)확장**으로 구별 할 수 있다.
 
  #### 수직적 확장
  
   단순히 DB 서버의 성능을 향상시키는 것 (Ex, CPU를 업그레이드 하는 방식)
  
  #### 수평적 확장
  
   더 많은 서버가 추가되고 DB가 전체적으로 분산됨을 의미한다. 따라서 하나이 DB에서 작동하지만 여러 호스트에서 작동한다.

 DB가 저장되는 방식 때문에 SQL DB는 일반적으로 수직적 확장만을 지원한다. 
 
  > 수평적 확장은 NoSQL DB에서만 가능하다.
 
 ![image](https://user-images.githubusercontent.com/32594290/102381456-9942a900-400c-11eb-9d2d-854e26679372.png)
 
 
 
 
## SQL, NoSQL 장단점

 ### SQL 장점
  
  - 명확하게 정의 된 스키마, 데이터 무결성 보장
  
  - 관계는 각 데이터를 중복없이 한번만 저장된다.
  
 ### SQL 단점
 
  - 상대적으로 덜 유연하다. 데이터 스키마는 사전에 계획되고 알려져야한다. (수정이 힘들거나 불가능할 수 있음)
  
  - 관계를 맺고 있기 때문에 JOIN문이 많은 매우 복잡한 쿼리가 만들어 질 수 잇다.
  
  - 수평적 확장이 어렵고 대체로 수직적 확장만 가능하다. 즉 어떤 시점에서 (처리할수 있는 처리량과 관련해서) 성장 한계에 직면한다.
  
 ### NoSQL 장점
 
  - 스키마가 없기 때문에 훨씬 더 **유연**하다. 즉, 언제든지 저장된 데이터를 조정하고 새로운 "필드"를 추가 할 수 있다.
  
  - 데이터는 애플리케이션이 필요로 하는 형식으로 저장된다. 이렇게 하면 데이터를 읽어오는 속도가 빨라진다.
  
  - 수직 및 **수평**확장이 가능하므로 DB가 애프리케이션에서 발생시키는 모든 읽기 / 쓰기 요청을 처리할 수 있다.
  
 ### NoSQL 단점
 
  - 유연성 때문에 데이터 구조 결정을 하지 못하고 미루게 될 수 있다.
  
  - 데이터 중복은 여러 컬렉션과 문서가 (SQL처럼 하나의 테이블에 하나의 레코드가 아닌) 여러 개의 레코드가 변경된 경우 업데이트를 해야 한다.
  
  - 데이터가 여러 컬렉션에 중복되어 있기 때문에 **수정(Update)**를 해야 하는 경우 **모든 컬렉션**에서 수행해야 함을 의미한다.
  (SQL에서는 중복된 데이터가 없기 때문에 한번만 수행)
  
- - - 
  
## SQL은 언제 사용하는 것이 좋은가?
 
 - 관계를 맺고 있는 데이터가 자주 수정되는 애플리케이션의 경우 
 
   > NoSQL이라면 여러 컬렉션을 모두 수정해야 함
 
 - 변경될 여지가 없고, 명확한 스키마가 사용자와 데이터에게 중요한 경우
 
## NoSQL은 언제 사용하는 것이 좋은가?

 - 정확한 데이터 구조를 알 수 없거나 변경 / 확장 될 수 있는 경우
 
 - 읽기(read)처리를 자주 하지만, 데이터를 자주 변경(update)하지 않는 경우 
 
   > 즉, 한번의 변경으로 수십개의 문서를 업데이트 할 필요가 없는 경우
 
 - DB를 수평으로 확장해야 하는 경우 
   
   > 막대한 양의 데이터를 다뤄야 하는 경우
 
그러나 SQL, NoSQL 모두 완전한 정답이 정해져 있는 것은 아님.
 
NoSQL DB를 쓰더라도 중복된 데이터를 줄이는 방법으로 단점을 완화할 수 있다.

SQL DB도 마찬가지로 요구사항을 만족시키고 복잡한 JOIN문을 만들지 않도록 설계할 수 있다.
