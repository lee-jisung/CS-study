## 배경

 이진 트리는 하나의 부모가 두 개의 자식밖에 갖지 못해 균형이 맞지 않으면 검색 효율이 선형 검색 정도의 성능으로 떨어진다.
 
 하지만 구조의 간결함과 균형만 맞다면 검색, 삽입, 삭제 모두 O(logN)의 성능을 보이는 장점이 있고, 이를 바탕으로 개선의 노력이 이어져왔다.
 
## B-Tree
 
 B-Tree는 이진 트리를 확장하여 더 많은 수의 자식을 가질 수 있게 한 자료구조로, 한 노드에 M개의 자료가 배치되면 M차 B-Tree라고 한다.
 
 스스로 균형을 맞추는 트리로, 최악의 경우에도 O(logN)의 검색 성능을 보인다.
 
 B-Tree는 레벨로만 따지면 완전히 균형을 맞춘 트리이다.

 대용량 데이터는 HDD나 SSD에 저장되어야 하는데, 이들 외부 기억장치는 블럭 단위로 입출력을 하기 때문에 하나의 노드에 많은 데이터를 가질 수
 있다는 것은 큰 장점이다.
 
 ``` 
  한 블럭이 1024byte라면, 2byte, 1024byte 두 경우에 대한 입출력 비용은 동일하다.
  
  하나의 노드를 1024byte가 되도록 조절한다면 입출력 면에서 매우 효율적일 것.
```

이러한 장점으로 실제 B-Tree는 많은 DB 시스템의 Index 저장 방법으로 사용되고 있다.

#### 규칙

 - 노드의 자료 수가 N이라면 자식의 수는 N+1이어야 한다.
 
 - 각 노드의 자료는 정렬된 상태여야 한다.
 
 - 루트 노드는 적어도 2개 이상의 자식을 가져야 한다.
 
 - 루트 노드를 제외한 모든 노드는 적어도 M/2개의 자료를 가지고 있어야 한다.
 
 - 외부 노드로 가는 경로의 길이는 모두 같다. (외부 노드는 모두 같은 레벨에 있음)
 
 - 입력 자료는 중복될 수 없다.
 
- - -

## B+ Tree

 B-Tree의 경우 순회 작업이 힘들다. B+ Tree는 Index 구조에서 순차 접근에 대한 문제의 해결책으로 제시되었다.
 
 B-Tree에서 특정 Key 값이 하나의 노드에만 존재할 수 있지만, B+ Tree는 leaf 노드와 leaf의 부모 노드에서 공존할 수 있다.
 
 B+ Tree의 비단말 노드 (internal node)들은 데이터의 빠른 접근을 위한 Index 역할만 하기 때문이다. (Index set이라 불림)
 
 그리고 leaf node들은 연결 리스트 형태로 서로 연결되어 있고 이를 순차 집합(Sequence set)이라고 하며, 오름차순으로 정렬되어 있다.
 
 따라서 B+ Tree는 **기존 B-Tree & 데이터의 연결 리스트**로 구현된 Index 구조라고 할 수 있다.
 

### 정리

 - B-Tree의 변형 구조로 Index 부분과 leaf 노드로 구성된 순차 data 부분으로 이루어짐.
 
 - Index 부분의 key 값은 leaf에 있는 key 값을 찾아가는데 사용하며 모든 key 값은 leaf 노드에 나열
   
   - 즉, Index 부분의 key 값도 leaf 노드에 다시 한번 나열됨
   
 - leaf 노드는 순차적으로 Linked list로 구성되어 있어 순차적인 Range 탐색에 유리하다.

 - 블럭 사이즈 (노드 사이즈)를 더 많이 이용할 수 있다. (키 값에 대한 HDD access 주소가 없기 때문)

- - - 

## B-Tree & B+ Tree 비교

### 공통점

 - 모든 leaf의 depth가 같다.
 
 - 각 node에는 k/2 ~ k개의 item이 들어있다.
 
 - Search가 비슷하다.
 
 - Add 시 Overflow가 발생하면 Split을 한다.
 
 - Delete 시 Underflow가 발생하면 redistribution을 하거나 merge를 한다.
 
### 차이점

 - B-tree의 각 노드에서는 Key 뿐만 아니라 data도 들어갈 수 있다. 여기서 Data는 dist block으로의 pointer가 될 수 있다.
 
   B+ tree는 각 node에서 Key만 들어가야 한다. 그러므로 B+ Tree에서 data는 오직 leaf에만 존재한다.
   
 - B+ Tree는 B-Tree와는 달리 Add, Delete가 leaf에서만 이루어진다.
 
 - B+ Tree는 Leaf node가 Linked list로 연결되어 있다.
 
 - B-Tree의 경우 Best case에는 루트에서 끝날 수 있으나 B+ Tree의 경우 무조건 leaf 노드까지 탐색해야 한다.
 

